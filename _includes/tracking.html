<script src="/js/cookie_utils.js"></script>

<div style="height: 300px;" class="printHide">
	<!-- Provide a region while the footer is visible to make the scroll go the whole way. -->&nbsp;
</div>

<div class="bg-secondary fixed-bottom printHide border-top border-secondary" style="display:none;" id="trackingConsent">
	<span title="This includes such data as referring site, browser type and size, and country of use.">By using this site, you agree to have anonymous data collected on your usage through Google Analytics.</span>
	<div><button class="btn btn-primary" onclick="hide()">Hide</button><div>

	<span>We use this to help us understand how we are doing on getting the word out, and what browsers we should be testing against to make sure the site works for all our readers.</span>
	<!-- consent footer -->
</div>


<script>
var hide_cookie = 'hide_analytics'
// from https://stackoverflow.com/a/5762713
function loadjscssfile(filename, filetype){
 if (filetype=="js"){ //if filename is a external JavaScript file
  var fileref=document.createElement('script')
  fileref.setAttribute("type","text/javascript")
  fileref.setAttribute("src", filename)
 }
 else if (filetype=="css"){ //if filename is an external CSS file
  var fileref=document.createElement("link")
  fileref.setAttribute("rel", "stylesheet")
  fileref.setAttribute("type", "text/css")
  fileref.setAttribute("href", filename)
 }
 if (typeof fileref!="undefined")
  document.getElementsByTagName("head")[0].appendChild(fileref)
}
function loadTracking() {
	loadjscssfile("/js/GA.js", "js") //dynamically load and add this .js file
}
loadTracking();
// on hide
function hide(from_cookie=false) {
	$('#trackingConsent').fadeOut(500)
	// if caused by user action, store cookie to prevent re-asking
	if(!from_cookie) {
		setCookie(hide_cookie, true, 90)
	}
}

function checkCookie() {
	cookieVal = getCookie(hide_cookie);
	hideVal = JSON.parse(cookieVal);
	if(hideVal) {
		loadTracking();
	}
	else {
		$('#trackingConsent').fadeIn(500)
	}
}
$(window).ready(checkCookie);
</script>